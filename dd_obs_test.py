#! /usr/bin/python3

from benchmark import *
from get_disk_info import *
from test_process import get_seek
import numpy as np

disk = sys.argv[1]
uuid = get_disk_uuid(disk)
print(uuid)
print(get_disk_info(disk))
size_in_blocks = int(get_disk_info(disk)) - 2*131072

bs = [2048, 4096, 8192, 16384, 32768, 65536, 131072]
"""
res_dic = {2048 : [], 4096 : [], 8192 : [], 16384 : [], 32768 : [], 65536 : [], 131072 : []}
for _ in range(10) :
	for i in bs : 
		seek = get_seek(i)
		count = size_in_blocks // (2*i)
		print(seek)
		res = fill_random(disk, count, i, seek) 
		print(i, res) 
		res_dic[i].append(res)
		print(res_dic)
	
"""

result = {2048: [861.3975958824158, 861.2612397670746, 859.6663856506348, 871.7808945178986, 865.2082643508911, 864.3263206481934, 862.6133079528809, 867.697368144989, 860.0449340343475, 865.5354466438293], 4096: [398.2728431224823, 401.24734807014465, 384.6992244720459, 394.91608810424805, 403.41623187065125, 406.0916495323181, 402.5035982131958, 383.2308301925659, 399.90648198127747, 383.9308490753174], 8192: [397.4810643196106, 401.55117630958557, 404.34303164482117, 385.2636408805847, 404.15605759620667, 403.73690271377563, 402.97856402397156, 404.2234363555908, 404.04505372047424, 405.9974751472473], 16384: [401.41052055358887, 401.6323881149292, 406.9571843147278, 384.05530428886414, 406.8581302165985, 403.1564416885376, 398.38145112991333, 403.94634222984314, 399.93734884262085, 384.1330797672272], 32768: [384.0967674255371, 403.67108631134033, 409.88880825042725, 408.61479902267456, 398.80783462524414, 411.8287835121155, 403.4031813144684, 401.44824862480164, 383.8183283805847, 402.1250069141388], 65536: [400.5036532878876, 398.56743717193604, 404.06551909446716, 384.1677038669586, 396.5946455001831, 386.5975458621979, 399.4370698928833, 402.3807005882263, 402.8776264190674, 396.9707236289978], 131072: [409.8897249698639, 402.39897990226746, 403.3417458534241, 406.5087811946869, 402.44215083122253, 406.2128529548645, 404.13198709487915, 407.84640073776245, 383.8687994480133, 382.7593460083008]}
mean = {}
for bs, tab in result.items() : 
	nptab = np.array(tab)
	mean[bs] = np.mean(nptab)

print(mean)

